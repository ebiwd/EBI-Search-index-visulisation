!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports,require("d3-quadtree")):"function"==typeof define&&define.amd?define(["exports","d3-quadtree"],b):b(a.d3=a.d3||{},a.d3)}(this,function(a,b){"use strict";function c(a){function c(a){return a.x+a.vx}function d(a){return a.y+a.vy}function e(a){return function(){return a}}function j(){function x(a,b,c,d,e){var f=a.data;{if(!f)return b>r||d<p||c>s||e<q;var i=l(o,0),k=l(o,1);if(f.node.index!==w){var m=f.node,n=g[m.index],t=m.x+m.vx+n[0][0],u=m.y+m.vy+n[0][1],v=m.x+m.vx+n[1][0],x=m.y+m.vy+n[1][1],y=l(n,0),z=l(n,1);if(p<=v&&t<=r&&q<=x&&u<=s){var A=[Math.min.apply(null,[t,v,p,r]),Math.max.apply(null,[t,v,p,r])],B=[Math.min.apply(null,[u,x,q,s]),Math.max.apply(null,[u,x,q,s])],C=i+y-(A[1]-A[0]),D=k+z-(B[1]-B[0]),E=C*h*(D/k),F=D*h*(C/i),G=C*h*(D/z),H=D*h*(C/y);(p+r)/2<(t+v)/2?(j.vx-=E,m.vx+=G):(j.vx+=E,m.vx-=G),(q+s)/2<(u+x)/2?(j.vy-=F,m.vy+=H):(j.vy+=F,m.vy-=H)}}}}var a,e,j,m,n,o,p,q,r,s,t=[];f.forEach(function(a,b){t.push({node:a,vx:a.vx,vy:a.vy,x:a.x+(g[b][1][0]+g[b][0][0])/2,y:a.y+(g[b][0][1]+g[b][1][1])/2}),t.push({node:a,vx:a.vx,vy:a.vy,x:a.x+g[b][0][0],y:a.y+g[b][0][1]}),t.push({node:a,vx:a.vx,vy:a.vy,x:a.x+g[b][0][0],y:a.y+g[b][1][1]}),t.push({node:a,vx:a.vx,vy:a.vy,x:a.x+g[b][1][0],y:a.y+g[b][0][1]}),t.push({node:a,vx:a.vx,vy:a.vy,x:a.x+g[b][1][0],y:a.y+g[b][1][1]})});for(var u=t.length,v=0;v<i;++v)for(e=b.quadtree(t,c,d).visitAfter(k),a=0;a<u;++a){var w=~~(a/5);j=f[w],o=g[w],m=j.x+j.vx,n=j.y+j.vy,p=m+o[0][0],q=n+o[0][1],r=m+o[1][0],s=n+o[1][1],e.visit(x)}}function k(a){if(a.data)return a.bb=g[a.data.node.index];a.bb=[[0,0],[0,0]];for(var b=0;b<4;++b)a[b]&&a[b].bb[0][0]<a.bb[0][0]&&(a.bb[0][0]=a[b].bb[0][0]),a[b]&&a[b].bb[0][1]<a.bb[0][1]&&(a.bb[0][1]=a[b].bb[0][1]),a[b]&&a[b].bb[1][0]>a.bb[1][0]&&(a.bb[1][0]=a[b].bb[1][0]),a[b]&&a[b].bb[1][1]>a.bb[1][1]&&(a.bb[1][1]=a[b].bb[1][1])}function l(a,b){return a[1][b]-a[0][b]}var f,g,h=1,i=1;return"function"!=typeof a&&(a=e(null===a?[[0,0][1]]:a)),j.initialize=function(b){var c,d=(f=b).length;for(g=new Array(d),c=0;c<d;++c)g[c]=a(f[c],c,f)},j.iterations=function(a){return arguments.length?(i=+a,j):i},j.strength=function(a){return arguments.length?(h=+a,j):h},j.bbox=function(b){return arguments.length?(a="function"==typeof b?b:e(+b),j):a},j}a.bboxCollide=c,Object.defineProperty(a,"__esModule",{value:!0})});
